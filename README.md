# Домашнее задание к занятию "`Репликация и масштабирование. Часть 2`" - `Дацко Иван`


### Инструкция по выполнению домашнего задания

   1. Сделайте `fork` данного репозитория к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/git-hw или  https://github.com/имя-вашего-репозитория/7-1-ansible-hw).
   2. Выполните клонирование данного репозитория к себе на ПК с помощью команды `git clone`.
   3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
      - впишите вверху название занятия и вашу фамилию и имя
      - в каждом задании добавьте решение в требуемом виде (текст/код/скриншоты/ссылка)
      - для корректного добавления скриншотов воспользуйтесь [инструкцией "Как вставить скриншот в шаблон с решением](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md)
      - при оформлении используйте возможности языка разметки md (коротко об этом можно посмотреть в [инструкции  по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md))
   4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`);
   5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
   6. Любые вопросы по выполнению заданий спрашивайте в чате учебной группы и/или в разделе “Вопросы по заданию” в личном кабинете.
   
Желаем успехов в выполнении домашнего задания!
   
### Дополнительные материалы, которые могут быть полезны для выполнения задания

1. [Руководство по оформлению Markdown файлов](https://gist.github.com/Jekins/2bf2d0638163f1294637#Code)

---


## Задание 1  
**Опишите основные преимущества использования масштабирования методами:**

### Активный master-сервер и пассивный репликационный slave-сервер

- **Отказоустойчивость**: при сбое master-сервера пассивный slave может быть переведён в режим master, обеспечивая непрерывность работы.
- **Резервное копирование без нагрузки**: бэкапы можно выполнять с пассивного slave, не влияя на производительность основного сервера.
- **Простота архитектуры**: всего два узла, легко настраивать и поддерживать.
- **Безопасность данных**: пассивный slave не обрабатывает запросы, что снижает риск несанкционированного доступа или ошибочных изменений.

> ⚠️ Такая схема **не масштабирует чтение**, так как slave не используется для обработки запросов.

---

### Master-сервер и несколько slave-серверов

- **Масштабирование операций чтения**: запросы `SELECT` можно распределять между несколькими slave, значительно снижая нагрузку на master.
- **Гибкость размещения**: slave можно размещать в разных географических регионах для снижения задержек у конечных пользователей.
- **Изоляция рабочих нагрузок**: один slave — для веб-интерфейса, другой — для аналитики, третий — для отчётов.
- **Повышенная отказоустойчивость**: потеря одного slave не влияет на работу системы.

> ❗ Запись по-прежнему возможна только на master, поэтому масштабирование записи таким способом не решается.

---

## Задание 2  
**Разработайте план для выполнения горизонтального и вертикального шардинга базы данных**, состоящей из трёх таблиц: **пользователи**, **книги**, **магазины**.

### Структура таблиц (предполагаемая)

| Таблица        | Основные поля |
|----------------|---------------|
| `пользователи` | `user_id`, `username`, `email`, `password_hash`, `full_name`, `profile_settings` |
| `книги`        | `book_id`, `title`, `author`, `genre_id`, `description`, `cover_image_url` |
| `магазины`     | `store_id`, `name`, `city`, `country`, `address`, `inventory` |

---

### Вертикальный шардинг

**Принцип**: разделение таблиц **по столбцам** — часто используемые данные и редко используемые/объёмные хранятся на разных серверах.

#### Распределение:

- **Сервер A (Core Data)**:
  - `пользователи_core`: `user_id`, `username`, `email`
  - `книги_core`: `book_id`, `title`, `author`, `genre_id`
  - `магазины_core`: `store_id`, `name`, `city`, `country`

- **Сервер B (Details)**:
  - `пользователи_details`: `user_id`, `password_hash`, `full_name`, `profile_settings`
  - `книги_full`: `book_id`, `description`, `cover_image_url`
  - `магазины_full`: `store_id`, `address`, `inventory`

**Режим работы**:  
Оба сервера — **активные**. Приложение само решает, когда запрашивать только основные данные, а когда — полный профиль.

---

### Горизонтальный шардинг

**Принцип**: разделение таблиц **по строкам** на основе ключа шардирования.

#### Распределение:

- **`пользователи`** → шардирование по `user_id` (хеш или диапазон):
  - **Shard U1**: `user_id % 2 = 0`
  - **Shard U2**: `user_id % 2 = 1`

- **`книги`** → шардирование по `genre_id`:
  - **Shard B1**: `genre_id IN (1,2,3)`
  - **Shard B2**: `genre_id IN (4,5,6)`
  - **Shard B3**: `genre_id >= 7`

- **`магазины`** → шардирование по `country`:
  - **Shard S_EU**: магазины в Европе (`DE`, `FR`, `IT`, ...)
  - **Shard S_ROW**: остальной мир

**Режим работы**:  
Все шарды — **активные**, хранят уникальные данные. Нет дублирования.  
Маршрутизация запросов осуществляется приложением или прокси-сервером на основе ключа шардирования.

---

### Блок-схема архитектуры (описание)

```
                             +------------------+
                             |    Приложение    |
                             +--------+---------+
                                      |
                    +-----------------v------------------+
                    |   Маршрутизатор (Shard Router)     |
                    | (выбирает сервер по ключу шарда)   |
                    +-----------------+------------------+
                                      |
         +----------------------------+----------------------------+
         |                            |                            |
+--------+-------+           +--------+-------+           +--------+-------+
| Вертикальный   |           | Горизонтальный |           | Горизонтальный |
| шардинг        |           | шардинг        |           | шардинг        |
| (Сервер A)     |           | (Шард U1, U2)  |           | (Шард B1-B3,   |
| - users_core   |           |                |           |  S_EU/ROW)      |
| - books_core   |           |                |           |                |
| - stores_core  |           |                |           |                |
+----------------+           +----------------+           +----------------+
         |                            |                            |
+--------v-------+           +--------v-------+           +--------v-------+
| Вертикальный   |           |                |           |                |
| шардинг        |           |                |           |                |
| (Сервер B)     |           |                |           |                |
| - users_det.   |           |                |           |                |
| - books_full   |           |                |           |                |
| - stores_full  |           |                |           |                |
+----------------+           +----------------+           +----------------+

```
